--- apache-tomcat-6.0.20-src.orig/build.xml	2009-05-14 08:15:28.000000000 +0900
+++ apache-tomcat-6.0.20-src/build.xml	2009-06-20 22:57:55.000000000 +0900
@@ -120,6 +120,7 @@
 <!-- Comment this in to show unchecked warnings:     <compilerarg value="-Xlint:unchecked"/> -->
       <classpath refid="tomcat.classpath" />
       <exclude name="org/apache/naming/factory/webservices/**" />
+      <exclude name="javax/servlet/**" />
     </javac>
     <tstamp>
       <format property="TODAY" pattern="MMM d yyyy" locale="en"/>
@@ -252,7 +253,7 @@
     <!-- Common Annotations 1.0 JAR File -->
     <jarIt jarfile="${annotations-api.jar}" filesId="files.annotations-api"/>
 
-    <!-- Servlet 2.5 Implementation JAR File -->
+    <!-- Servlet 2.5 Implementation JAR File
     <filter token="implementation.revision"
             value="${servlet.revision}"/>
     <copy tofile="res/manifest.tmp"
@@ -265,14 +266,14 @@
         <include name="META-INF/**" />
       </fileset>
       <fileset dir="${tomcat.classes}">
-        <patternset refid="files.servlet-api"/>
-        <!-- Javadoc and i18n exclusions -->
+        <patternset refid="files.servlet-api"/>-->
+        <!-- Javadoc and i18n exclusions
         <exclude name="**/package.html" />
         <exclude name="**/LocalStrings_*" />
       </fileset>
     </jar>
-
-    <!-- JSP 2.1 Implementation JAR File -->
+    -->
+    <!-- JSP 2.1 Implementation JAR File
     <filter token="implementation.revision"
             value="${jsp.revision}"/>
     <copy tofile="res/manifest.tmp"
@@ -285,13 +286,13 @@
         <include name="META-INF/**" />
       </fileset>
       <fileset dir="${tomcat.classes}">
-        <patternset refid="files.jsp-api"/>
-        <!-- Javadoc and i18n exclusions -->
+        <patternset refid="files.jsp-api"/>-->
+        <!-- Javadoc and i18n exclusions
         <exclude name="**/package.html" />
         <exclude name="**/LocalStrings_*" />
       </fileset>
     </jar>
-
+    -->
     <!-- JSP 2.1 EL Implementation JAR File -->
     <jarIt jarfile="${el-api.jar}" filesId="files.el-api"/>
 
@@ -349,7 +350,7 @@
 
   </target>
 
-  <target name="build-docs">
+  <target name="build-docs" unless="nobuild.docs">
 
     <copy todir="${tomcat.build}/webapps">
       <fileset dir="webapps">
@@ -439,11 +440,15 @@
   
   <target name="deploy" depends="build-only,build-docs,warn.dbcp">
 
+<!--
     <copy tofile="${tomcat.build}/bin/tomcat-native.tar.gz"
             file="${tomcat-native.tar.gz}" />
+-->
 
     <copy todir="${tomcat.build}/bin" file="${commons-daemon.jar}" />
+<!--
     <copy todir="${tomcat.build}/bin" file="${commons-daemon.jsvc.tar.gz}" />
+-->
 
     <!-- Copy scripts -->
     <copy todir="${tomcat.build}/bin">
@@ -484,7 +489,7 @@
              source="${compile.source}"
              target="${compile.target}"
              optimize="${compile.optimize}"
-             classpath="${tomcat.classes}"
+             classpath="${tomcat.classes}:${jsp-api.jar}"
              excludes="**/CVS/**,**/.svn/**">
     </javac>
 
@@ -576,9 +581,11 @@
       </fileset>
     </txt2html>
 
+<!--
     <copy file="${tomcat-dbcp.jar}" todir="${tomcat.build}/lib" 
       failonerror="false"/>
     <copy file="${jasper-jdt.jar}" todir="${tomcat.build}/lib" />
+-->
 
   </target>
 
